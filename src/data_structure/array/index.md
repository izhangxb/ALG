
# 数组

数组是一种线性表数据结构，它用一组连续的内存空间，来存储一组具有相同类型的数据。（JS 允许不同类型）

数据内存计算公式：
```$xslt
a[i]_address = base_address + i * data_type_size
```

## 低效的插入
当我么你需要将一个数据插入K位置时，由于数组内存的连续性，需要将第K+1之后的数据以此后移，所花的平均时间复杂度为O(n);
有一种技巧是，如果当前数据对顺序无要求，可以将K位置的元素替换，将原数据放至队尾，将时间复杂度降低为O(1)。

## 低效的删除
与插入类似，由于内存的连续性，需要将K位置后面的数据一次前移，平均时间复杂度也为O(n);
当我们不需要最求数据数据的连续性的时候，可以将多次删除的操作集中处理，当删除数据时，我们只是将数据标记删除，当数组没有更多空间的时候，再出发真正的删除操作，
从而大大减少删除操作导致的数据搬移。而这也正是JVM标记清除垃圾回收算法的核心思想。

## 容器VS数组
很多语言提供了容器类，例如JAVA的ArrayList， C++的Vector等

容器优势：
1. 封装操作细节，无需关心插入，删除时的数据搬移。
2. 支持动态扩展。但是由于扩容操作涉及内存申请和数据搬移，比较耗时，所以最好在创建ArrayList的时候就指定容器的大小。

数组的优势：
1. Java的ArrayList无法存储基本数据类型，比如 int、
、long，需要封装为 Integer、Long 类，而 Autoboxing、Unboxing 则有一定的性能消耗，
所以如果特别关注性能，或者希望使用基本类型，就可以选用数组。
2. 如果数据大小事先已知，并且对数据的操作非常简单，用不到容器提供的大部分方法，也可以使用数组。
3. 用数组表示，显示更为直观。

总结：对于普通业务开发，使用容器足够，损失一丢丢性能，不影响整体性能；如果是做底层开发，需要对性能优化到极致，这个时候可能优先选择数组。

## 为什么大多数变成语言中，数组都从0开始？
1. 从内存模型来看，下表的确切定义应该是'偏移'，用0表示，更符合内存地址的计算公式。如果从1开始，那么计算公式就会变成：
```$xslt
a[k]_address = base_address + (k-1)*type_size
```
那么每次随机访问数组元素，就会多运行一次减法运算，会造成效率的降低。

2. 历史原因，参考C语言的设计。

